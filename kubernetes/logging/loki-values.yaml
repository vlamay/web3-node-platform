# Loki and Promtail Configuration for Geth Node Logging

# Promtail Values (Simplified for reference)
# Using Helm is recommended: helm install promtail grafana/promtail --values kubernetes/logging/promtail-values.yaml

promtail:
  enabled: true
  config:
    loki_address: http://loki.observability.svc.cluster.local:3100/loki/api/v1/push
    snippets:
      extraScrapeConfigs: |
        - job_name: geth-logs
          kubernetes_sd_configs:
            - role: pod
          relabel_configs:
            - source_labels: [__meta_kubernetes_pod_label_app]
              action: keep
              regex: geth
            - action: replace
              source_labels: [__meta_kubernetes_pod_name]
              target_label: pod
            - action: replace
              source_labels: [__meta_kubernetes_namespace]
              target_label: namespace
---
# Loki Values
loki:
  enabled: true
  persistence:
    enabled: true
    size: 20Gi
    storageClassName: gp3
  config:
    limits_config:
      retention_period: 168h # 7 days
